(function($){$.fn.extend({ribbon:function(options){var defaults={darken_by:20,left_curl:true,right_curl:true,triangle_width:15,direction:'up'}
var options=$.extend(defaults,options);return this.each(function(){var o=options;var ribbon=$(this);var color=$(ribbon).css('backgroundColor');var height=$(ribbon).outerHeight();var width=$(ribbon).outerWidth();var dark_color=darken(color,o.darken_by);$(ribbon).wrap('<div class="rectangle"></div>');$(ribbon).parent().css({position:'relative',zIndex:'50',display:'inline-block'});if((o.left_curl)&&(o.right_curl)){$(ribbon).css('width',$(ribbon).width()+(2*o.triangle_width));width=$(ribbon).outerWidth();}
if(o.left_curl){$(ribbon).parent().append('<div class="triangle triangle-l"></div>');var tl_l=$(ribbon).position().left-o.triangle_width;var tl_t;if(o.direction=='down'){tl_t=$(ribbon).position().top-parseInt(o.triangle_width);}else{tl_t=$(ribbon).position().top+parseInt(height)-parseInt(o.triangle_width);}
var tl=$(ribbon).parent().find('.triangle-l');tl.css({'border-color':'transparent '+dark_color+'transparent transparent','border-style':'solid','border-width':o.triangle_width+'px','top':tl_t,'left':tl_l,'height':'0px','width':'0px','position':'absolute','z-index':'-1'});}
if(o.right_curl){$(ribbon).parent().append('<div class="triangle triangle-r"></div>');var tr_l=$(ribbon).position().left+width-(o.triangle_width);var tr_t;if(o.direction=='down'){tr_t=$(ribbon).position().top-o.triangle_width;}else{tr_t=$(ribbon).position().top+parseInt(height)-o.triangle_width;}
var tr=$(ribbon).parent().find('.triangle-r');tr.css({'border-color':'transparent transparent transparent '+dark_color,'top':tr_t,'left':tr_l,'border-style':'solid','border-width':o.triangle_width+'px','height':'0px','width':'0px','position':'absolute','z-index':'-1'});}
if((o.right_curl)&&(!o.left_curl)){$(ribbon).parent().css('right',-o.triangle_width);}else if(o.left_curl){$(ribbon).parent().css('left',-o.triangle_width);}});function hex2rgb(hex){hex=(hex.substr(0,1)=="#")?hex.substr(1):hex;return'rgb('+parseInt(hex.substr(0,2),16)+','+parseInt(hex.substr(2,2),16)+','+parseInt(hex.substr(4,2),16)+')';}
function darken(color,percentage){var local_color=color;var deduction=Math.round(255*(percentage/100));if(color.charAt(0)=='#'){local_color=hex2rgb(color.substring(1));}
var parts=new Array();parts=local_color.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);var r=(parts[1]-deduction>0)?parts[1]-deduction:0;var g=(parts[2]-deduction>0)?parts[2]-deduction:0;var b=(parts[3]-deduction>0)?parts[3]-deduction:0;return'rgb('+r+','+g+','+b+')';}}});})(jQuery);